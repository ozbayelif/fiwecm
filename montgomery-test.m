load "/home/ozbayelif/Development/FIWE/ecm/montgomery.m";

F:=GF(468157);
A:=F!203336;
B:=F!43079;
S<X,Y,Z>:=ProjectiveSpace(F,2);
C<X,Y,Z>:=Curve(S,[B*Y^2*Z-(X^3+A*X^2*Z+X*Z^2)]);
W,MtoW:=EllipticCurve(C,C![0,1,0]);
WtoM:=Inverse(MtoW);

X1:=F!394924/47903;
Y1:=F!320232/47903;
P:=C![X1,Y1,1];
A24:=(A+2)/4;

/****************************************************************************/

WtoM(2*MtoW(P));
dblM(X1,Y1,A,B);
DBLM(X1,1,A24);

/****************************************************************************/

X2,Z2:=DBLM(X1,1,A24);
X4,Z4:=DBLM(X2,Z2,A24);
X3,Z3:=ADDM(X2,Z2,X1,1,X1,1);
LADDM(X1,1,3,A24);

/****************************************************************************/

WtoM(87348*MtoW(P));
LADDM(X1,1,87348,A24);

/****************************************************************************/